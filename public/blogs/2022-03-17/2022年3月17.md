

梦想是到腾讯实习，北上广深冲冲冲！

>111

|   1    |               22                |
| :----: | :-----------------------------: |
|   QQ   |            530394623            |
|  邮箱  |        530394623@qq.com         |
| Github | https://github.com/gangganghao6 |
|  微信  |            DY001628             |
|  手机  |           17798060972           |
|  生日  |            2001.8.17            |

```js
function storeFiles(req, res, type) {
  let date = createMkdr(type)
  let filePath = path.join(path.join(localConfig.publicPath, type), date)
  let form = new formidable.IncomingForm()
  let fileNames = []
  form.encoding = 'utf-8'
  form.uploadDir = filePath
  form.keepExtensions = true
  form.maxFieldsSize = 100 * 1024 * 1024;
  form.multiples = true;
  form.parse(req, async (err, fields, files) => {
    let length = Object.keys(files).length;
    let fileKeyNames = Object.keys(files)
    for (let i = 0; i < length; i++) {
      let username = fileKeyNames[i]
      let fileName = await createFileHash256(files[username].filepath) + "." + files[username].mimetype.split('/')[1]
      console.log(files[username].mimetype)
      fs.rename(files[username].filepath, path.join(filePath, fileName), function (err) {
        if (err) {
          throw Error("改名失败");
        }
      })
      fileNames.push(fileName)
    }
    res.json(fileNames)
  })
}
```

[src]:http://localhost:3000/blogImages/2022-03-02/21aad9d3a3b24afaae982fcbeb976430e0200c665dc0b66abe10801a7de1c5c6.jpeg



![img](http://192.168.31.30:3000/blogs/2022-03-17/Cache_-7e6e26d640d98c97.-16474022173861.jpg)

![img](http://192.168.31.30:3000/blogs/2022-03-17/Cache_-7e6e26d640d98c97..jpg)

![img](http://192.168.31.30:3000/blogs/2022-03-17/DC6162E6ABEE7AE4AB242529E550B298.png)
